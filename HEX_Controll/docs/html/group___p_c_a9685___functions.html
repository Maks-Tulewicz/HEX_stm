<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hexapod Control System: Funkcje publiczne API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Hexapod Control System<span id="projectnumber">&#160;v1.0</span>
   </div>
   <div id="projectbrief">Advanced 6-legged robot control system with multiple gait algorithms</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group___p_c_a9685___functions.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Funkcje publiczne API</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga203255701e78f73a8d5a91916df5f106" id="r_ga203255701e78f73a8d5a91916df5f106"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_a9685___functions.html#ga203255701e78f73a8d5a91916df5f106">PCA9685_Init</a> (<a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *handle, <a class="el" href="struct_i2_c___handle_type_def.html">I2C_HandleTypeDef</a> *hi2c, uint8_t address)</td></tr>
<tr class="memdesc:ga203255701e78f73a8d5a91916df5f106"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inicjalizacja kontrolera PCA9685.  <br /></td></tr>
<tr class="separator:ga203255701e78f73a8d5a91916df5f106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa1cd96bb12e5196ad7641c41e3f24ec0" id="r_gaa1cd96bb12e5196ad7641c41e3f24ec0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_a9685___functions.html#gaa1cd96bb12e5196ad7641c41e3f24ec0">PCA9685_SetServoAngle</a> (<a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *handle, uint8_t channel, float angle)</td></tr>
<tr class="memdesc:gaa1cd96bb12e5196ad7641c41e3f24ec0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ustawienie kąta serwomechanizmu (0-180°)  <br /></td></tr>
<tr class="separator:gaa1cd96bb12e5196ad7641c41e3f24ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae723d43fb9f64618bec71ee56f9c53d0" id="r_gae723d43fb9f64618bec71ee56f9c53d0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_a9685___functions.html#gae723d43fb9f64618bec71ee56f9c53d0">PCA9685_TestPWMRange</a> (<a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *handle, uint8_t channel, uint16_t pwm_min, uint16_t pwm_max)</td></tr>
<tr class="memdesc:gae723d43fb9f64618bec71ee56f9c53d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test różnych zakresów PWM dla kalibracji serw.  <br /></td></tr>
<tr class="separator:gae723d43fb9f64618bec71ee56f9c53d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf7ada39a0604e4e7b0db1ff41f7f3fc" id="r_gaaf7ada39a0604e4e7b0db1ff41f7f3fc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_a9685___functions.html#gaaf7ada39a0604e4e7b0db1ff41f7f3fc">PCA9685_SetPWM</a> (<a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *handle, uint8_t channel, uint16_t pwm_value)</td></tr>
<tr class="memdesc:gaaf7ada39a0604e4e7b0db1ff41f7f3fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ustawienie surowej wartości PWM (0-4095)  <br /></td></tr>
<tr class="separator:gaaf7ada39a0604e4e7b0db1ff41f7f3fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a4fffe86f072b258603b4e1b5739c9f" id="r_ga9a4fffe86f072b258603b4e1b5739c9f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_c_a9685___functions.html#ga9a4fffe86f072b258603b4e1b5739c9f">PCA9685_SetChannelOff</a> (<a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *handle, uint8_t channel)</td></tr>
<tr class="memdesc:ga9a4fffe86f072b258603b4e1b5739c9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Całkowite wylączenie kanału PWM.  <br /></td></tr>
<tr class="separator:ga9a4fffe86f072b258603b4e1b5739c9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga203255701e78f73a8d5a91916df5f106" name="ga203255701e78f73a8d5a91916df5f106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga203255701e78f73a8d5a91916df5f106">&#9670;&#160;</a></span>PCA9685_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PCA9685_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_i2_c___handle_type_def.html">I2C_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hi2c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inicjalizacja kontrolera PCA9685. </p>
<p><b>Sekwencja inicjalizacji (bez software reset!):</b></p><ol type="1">
<li>Test komunikacji I2C (HAL_I2C_IsDeviceReady)</li>
<li>Ustawienie MODE1 = 0x20 (auto-increment enabled)</li>
<li>Wejście w tryb sleep dla zmiany prescaler</li>
<li>Ustawienie prescaler = 121 (50Hz)</li>
<li>Wyjście z trybu sleep</li>
<li>Delay 5ms na stabilizację oscylatora</li>
</ol>
<p><b>Dlaczego brak software reset?</b> Software reset (MODE1 bit 7) powoduje problemy z komunikacją I2C w niektórych konfiguracjach STM32. Manual reset jest bezpieczniejszy.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">handle</td><td>Wskaźnik na strukturę handlera (musi być zaalokowana) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hi2c</td><td>Wskaźnik na handle I2C HAL (np. &amp;hi2c1, &amp;hi2c2) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">address</td><td>7-bitowy adres I2C (PCA9685_ADDRESS_1 lub PCA9685_ADDRESS_2)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true Inicjalizacja zakończona sukcesem </dd>
<dd>
false Błąd inicjalizacji (sprawdź połączenia I2C)</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Upewnij się, że I2C jest poprawnie skonfigurowany przed wywołaniem </dd>
<dd>
handle-&gt;ready zostanie ustawiony na false w przypadku błędu</dd></dl>
<div class="fragment"><div class="line"><span class="comment">// Przykład użycia</span></div>
<div class="line"><a class="code hl_struct" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> <a class="code hl_variable" href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a>;</div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_function" href="group___p_c_a9685___functions.html#ga203255701e78f73a8d5a91916df5f106">PCA9685_Init</a>(&amp;<a class="code hl_variable" href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a>, &amp;<a class="code hl_variable" href="i2c_8h.html#af7b2c26e44dadaaa798a5c3d82914ba7">hi2c1</a>, <a class="code hl_define" href="group___p_c_a9685___constants.html#ga7aaa37d79f1b5d4eb3b038fd53d251a1">PCA9685_ADDRESS_1</a>)) {</div>
<div class="line">    <span class="comment">// Obsługa błędu - miganie LED, restart, itp.</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup___p_c_a9685___constants_html_ga7aaa37d79f1b5d4eb3b038fd53d251a1"><div class="ttname"><a href="group___p_c_a9685___constants.html#ga7aaa37d79f1b5d4eb3b038fd53d251a1">PCA9685_ADDRESS_1</a></div><div class="ttdeci">#define PCA9685_ADDRESS_1</div><div class="ttdoc">Adresy I2C kontrolerów PCA9685 (7-bitowe)</div><div class="ttdef"><b>Definition</b> <a href="pca9685_8h_source.html#l00089">pca9685.h:89</a></div></div>
<div class="ttc" id="agroup___p_c_a9685___functions_html_ga203255701e78f73a8d5a91916df5f106"><div class="ttname"><a href="group___p_c_a9685___functions.html#ga203255701e78f73a8d5a91916df5f106">PCA9685_Init</a></div><div class="ttdeci">bool PCA9685_Init(PCA9685_Handle_t *handle, I2C_HandleTypeDef *hi2c, uint8_t address)</div><div class="ttdoc">Inicjalizacja kontrolera PCA9685.</div><div class="ttdef"><b>Definition</b> <a href="pca9685_8c_source.html#l00022">pca9685.c:22</a></div></div>
<div class="ttc" id="ai2c_8h_html_af7b2c26e44dadaaa798a5c3d82914ba7"><div class="ttname"><a href="i2c_8h.html#af7b2c26e44dadaaa798a5c3d82914ba7">hi2c1</a></div><div class="ttdeci">I2C_HandleTypeDef hi2c1</div><div class="ttdef"><b>Definition</b> <a href="i2c_8c_source.html#l00027">i2c.c:27</a></div></div>
<div class="ttc" id="amain_8c_html_ae574d11146c164ecae358a62f95f0256"><div class="ttname"><a href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a></div><div class="ttdeci">PCA9685_Handle_t pca1</div><div class="ttdoc">Handlery kontrolerów PCA9685.</div><div class="ttdef"><b>Definition</b> <a href="main_8c_source.html#l00119">main.c:119</a></div></div>
<div class="ttc" id="astruct_p_c_a9685___handle__t_html"><div class="ttname"><a href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a></div><div class="ttdoc">Struktura handlera PCA9685.</div><div class="ttdef"><b>Definition</b> <a href="pca9685_8h_source.html#l00148">pca9685.h:149</a></div></div>
</div><!-- fragment --><p>Inicjalizacja kontrolera PCA9685.</p>
<p>This function uses the EXACT working sequence from manual testing:</p><ol type="1">
<li>Test I2C communication</li>
<li>Set MODE1 register to 0x20 (auto-increment enabled)</li>
<li>Configure 50Hz frequency (prescaler = 121)</li>
<li>No software reset to avoid instability </li>
</ol>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="pca9685_basic_example_8c-example.html#a1">pca9685_basic_example.c</a>, <a class="el" href="pca9685_dual_controller_8c-example.html#a1">pca9685_dual_controller.c</a>, and <a class="el" href="tripod_basic_8c-example.html#a3">tripod_basic.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pca9685_8c_source.html#l00022">22</a> of file <a class="el" href="pca9685_8c_source.html">pca9685.c</a>.</p>

</div>
</div>
<a id="ga9a4fffe86f072b258603b4e1b5739c9f" name="ga9a4fffe86f072b258603b4e1b5739c9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9a4fffe86f072b258603b4e1b5739c9f">&#9670;&#160;</a></span>PCA9685_SetChannelOff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PCA9685_SetChannelOff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>channel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Całkowite wylączenie kanału PWM. </p>
<p>Ustawia wartość PWM na 0, co skutkuje brakiem pulsu wyjściowego. Przydatne do oszczędzania energii lub "odłączenia" serwomechanizmu.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">handle</td><td>Wskaźnik na zainicjalizowany handel PCA9685 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">channel</td><td>Kanał PWM (0-15)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true Kanał wyłączony pomyślnie </dd>
<dd>
false Błąd komunikacji I2C</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Equivalent: PCA9685_SetPWM(handle, channel, 0) </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Servo może stracić kontrolę pozycji po wyłączeniu PWM</dd></dl>
<div class="fragment"><div class="line"><span class="comment">// Wylączenie wszystkich kanałów dla oszczędzania energii</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 16; i++) {</div>
<div class="line">    <a class="code hl_function" href="group___p_c_a9685___functions.html#ga9a4fffe86f072b258603b4e1b5739c9f">PCA9685_SetChannelOff</a>(&amp;<a class="code hl_variable" href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a>, i);</div>
<div class="line">}</div>
<div class="ttc" id="agroup___p_c_a9685___functions_html_ga9a4fffe86f072b258603b4e1b5739c9f"><div class="ttname"><a href="group___p_c_a9685___functions.html#ga9a4fffe86f072b258603b4e1b5739c9f">PCA9685_SetChannelOff</a></div><div class="ttdeci">bool PCA9685_SetChannelOff(PCA9685_Handle_t *handle, uint8_t channel)</div><div class="ttdoc">Całkowite wylączenie kanału PWM.</div><div class="ttdef"><b>Definition</b> <a href="pca9685_8c_source.html#l00183">pca9685.c:183</a></div></div>
</div><!-- fragment --><p>Całkowite wylączenie kanału PWM. </p>

<p class="definition">Definition at line <a class="el" href="pca9685_8c_source.html#l00183">183</a> of file <a class="el" href="pca9685_8c_source.html">pca9685.c</a>.</p>

</div>
</div>
<a id="gaaf7ada39a0604e4e7b0db1ff41f7f3fc" name="gaaf7ada39a0604e4e7b0db1ff41f7f3fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf7ada39a0604e4e7b0db1ff41f7f3fc">&#9670;&#160;</a></span>PCA9685_SetPWM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PCA9685_SetPWM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>pwm_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ustawienie surowej wartości PWM (0-4095) </p>
<p>Niskopoziomowa funkcja bezpośrednio zapisująca wartość PWM do rejestrów. Replikuje sprawdzoną sekwencję z manualnych testów I2C.</p>
<p><b>Rejestry kanału (każdy kanał = 4 rejestry):</b></p><ul>
<li>ON_L: 0x00 (start PWM w cyklu)</li>
<li>ON_H: 0x00</li>
<li>OFF_L: pwm_value &amp; 0xFF (koniec PWM w cyklu)</li>
<li>OFF_H: (pwm_value &gt;&gt; 8) &amp; 0xFF</li>
</ul>
<p><b>Kalkulacja czasu pulsu:</b> </p><div class="fragment"><div class="line">pulse_width = (pwm_value / 4096) * 20ms</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">handle</td><td>Wskaźnik na zainicjalizowany handel PCA9685 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">channel</td><td>Kanał PWM (0-15) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pwm_value</td><td>Wartość PWM (0-4095, automatycznie ograniczana)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true Wartość PWM ustawiona pomyślnie </dd>
<dd>
false Błąd (nieprawidłowy handle, kanał lub komunikacja I2C)</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Funkcja automatycznie ogranicza pwm_value do maksimum 4095 </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group___p_c_a9685___functions.html#gaa1cd96bb12e5196ad7641c41e3f24ec0" title="Ustawienie kąta serwomechanizmu (0-180°)">PCA9685_SetServoAngle()</a> dla wygodniejszego ustawiania kątów</dd></dl>
<div class="fragment"><div class="line"><span class="comment">// Bezpośrednie ustawienie PWM (dla zaawansowanych)</span></div>
<div class="line"><a class="code hl_function" href="group___p_c_a9685___functions.html#gaaf7ada39a0604e4e7b0db1ff41f7f3fc">PCA9685_SetPWM</a>(&amp;<a class="code hl_variable" href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a>, 0, 305);  <span class="comment">// ~90° dla MG996R</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Wylączenie kanału (brak pulsu)</span></div>
<div class="line"><a class="code hl_function" href="group___p_c_a9685___functions.html#gaaf7ada39a0604e4e7b0db1ff41f7f3fc">PCA9685_SetPWM</a>(&amp;<a class="code hl_variable" href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a>, 0, 0);</div>
<div class="ttc" id="agroup___p_c_a9685___functions_html_gaaf7ada39a0604e4e7b0db1ff41f7f3fc"><div class="ttname"><a href="group___p_c_a9685___functions.html#gaaf7ada39a0604e4e7b0db1ff41f7f3fc">PCA9685_SetPWM</a></div><div class="ttdeci">bool PCA9685_SetPWM(PCA9685_Handle_t *handle, uint8_t channel, uint16_t pwm_value)</div><div class="ttdoc">Ustawienie surowej wartości PWM (0-4095)</div><div class="ttdef"><b>Definition</b> <a href="pca9685_8c_source.html#l00143">pca9685.c:143</a></div></div>
</div><!-- fragment --><p>Ustawienie surowej wartości PWM (0-4095)</p>
<p>This function replicates the proven manual I2C commands that made servo move: HAL_I2C_Mem_Write(&amp;hi2c1, 0x80, 0x06, 1, (uint8_t[]){0, 0, pwm_low, pwm_high}, 4, 1000);</p>
<p>Each channel uses 4 registers: ON_L, ON_H, OFF_L, OFF_H</p><ul>
<li>ON = 0 (PWM starts at beginning of cycle)</li>
<li>OFF = pwm_value (PWM ends after pwm_value steps) </li>
</ul>

<p class="definition">Definition at line <a class="el" href="pca9685_8c_source.html#l00143">143</a> of file <a class="el" href="pca9685_8c_source.html">pca9685.c</a>.</p>

</div>
</div>
<a id="gaa1cd96bb12e5196ad7641c41e3f24ec0" name="gaa1cd96bb12e5196ad7641c41e3f24ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa1cd96bb12e5196ad7641c41e3f24ec0">&#9670;&#160;</a></span>PCA9685_SetServoAngle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PCA9685_SetServoAngle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ustawienie kąta serwomechanizmu (0-180°) </p>
<p>Funkcja konwertuje kąt w stopniach na odpowiednią wartość PWM używając sprawdzonych wartości dla MG996R:</p>
<p><b>Mapowanie kątów:</b></p><ul>
<li>0° → 110 PWM</li>
<li>90° → 305 PWM</li>
<li>180° → 500 PWM</li>
</ul>
<p><b>Interpolacja liniowa:</b> </p><div class="fragment"><div class="line">pwm_value = <a class="code hl_define" href="group___p_c_a9685___constants.html#gaee1ba67389a6ff36eddac6f797885ed5">SERVO_PWM_MIN</a> + (angle/180.0) * (<a class="code hl_define" href="group___p_c_a9685___constants.html#ga6cd88c9bbbf277fdfe11f0effe23a004">SERVO_PWM_MAX</a> - <a class="code hl_define" href="group___p_c_a9685___constants.html#gaee1ba67389a6ff36eddac6f797885ed5">SERVO_PWM_MIN</a>)</div>
<div class="ttc" id="agroup___p_c_a9685___constants_html_ga6cd88c9bbbf277fdfe11f0effe23a004"><div class="ttname"><a href="group___p_c_a9685___constants.html#ga6cd88c9bbbf277fdfe11f0effe23a004">SERVO_PWM_MAX</a></div><div class="ttdeci">#define SERVO_PWM_MAX</div><div class="ttdoc">180° (2.44ms pulse width)</div><div class="ttdef"><b>Definition</b> <a href="pca9685_8h_source.html#l00128">pca9685.h:128</a></div></div>
<div class="ttc" id="agroup___p_c_a9685___constants_html_gaee1ba67389a6ff36eddac6f797885ed5"><div class="ttname"><a href="group___p_c_a9685___constants.html#gaee1ba67389a6ff36eddac6f797885ed5">SERVO_PWM_MIN</a></div><div class="ttdeci">#define SERVO_PWM_MIN</div><div class="ttdoc">Sprawdzone wartości PWM dla MG996R.</div><div class="ttdef"><b>Definition</b> <a href="pca9685_8h_source.html#l00127">pca9685.h:127</a></div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">handle</td><td>Wskaźnik na zainicjalizowany handel PCA9685 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">channel</td><td>Kanał PWM (0-15) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>Kąt w stopniach (0.0 - 180.0)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true Kąt ustawiony pomyślnie </dd>
<dd>
false Błąd (nieprawidłowy handle, kanał lub komunikacja I2C)</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Kąt jest automatycznie ograniczany do zakresu 0-180° </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Upewnij się, że serwomechanizm jest zasilany (V+ na PCA9685)</dd></dl>
<div class="fragment"><div class="line"><span class="comment">// Ustawienie biodra nogi 1 na 45°</span></div>
<div class="line"><a class="code hl_function" href="group___p_c_a9685___functions.html#gaa1cd96bb12e5196ad7641c41e3f24ec0">PCA9685_SetServoAngle</a>(&amp;<a class="code hl_variable" href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a>, 0, 45.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Ustawienie kolana nogi 1 na pozycję neutralną</span></div>
<div class="line"><a class="code hl_function" href="group___p_c_a9685___functions.html#gaa1cd96bb12e5196ad7641c41e3f24ec0">PCA9685_SetServoAngle</a>(&amp;<a class="code hl_variable" href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a>, 1, 90.0f);</div>
<div class="ttc" id="agroup___p_c_a9685___functions_html_gaa1cd96bb12e5196ad7641c41e3f24ec0"><div class="ttname"><a href="group___p_c_a9685___functions.html#gaa1cd96bb12e5196ad7641c41e3f24ec0">PCA9685_SetServoAngle</a></div><div class="ttdeci">bool PCA9685_SetServoAngle(PCA9685_Handle_t *handle, uint8_t channel, float angle)</div><div class="ttdoc">Ustawienie kąta serwomechanizmu (0-180°)</div><div class="ttdef"><b>Definition</b> <a href="pca9685_8c_source.html#l00086">pca9685.c:86</a></div></div>
</div><!-- fragment --><p>Ustawienie kąta serwomechanizmu (0-180°)</p>
<p>Testing wider PWM range for MG996R's full 180° rotation:</p><ul>
<li>0° -&gt; SERVO_PWM_MIN (100) - extended minimum</li>
<li>90° -&gt; SERVO_PWM_MID (375) - tested working center</li>
<li>180° -&gt; SERVO_PWM_MAX (650) - extended maximum </li>
</ul>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="pca9685_basic_example_8c-example.html#a5">pca9685_basic_example.c</a>, and <a class="el" href="pca9685_dual_controller_8c-example.html#a6">pca9685_dual_controller.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pca9685_8c_source.html#l00086">86</a> of file <a class="el" href="pca9685_8c_source.html">pca9685.c</a>.</p>

</div>
</div>
<a id="gae723d43fb9f64618bec71ee56f9c53d0" name="gae723d43fb9f64618bec71ee56f9c53d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae723d43fb9f64618bec71ee56f9c53d0">&#9670;&#160;</a></span>PCA9685_TestPWMRange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PCA9685_TestPWMRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_p_c_a9685___handle__t.html">PCA9685_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>pwm_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>pwm_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test różnych zakresów PWM dla kalibracji serw. </p>
<p>Funkcja testowa pozwalająca na eksperymentalne określenie optymalnych wartości PWM dla konkretnego modelu serwomechanizmu.</p>
<p><b>Sekwencja testu:</b></p><ol type="1">
<li>Ustawienie PWM minimum → delay 2s</li>
<li>Ustawienie PWM środek → delay 2s</li>
<li>Ustawienie PWM maksimum → delay 2s</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">handle</td><td>Wskaźnik na zainicjalizowany handel PCA9685 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">channel</td><td>Kanał PWM (0-15) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pwm_min</td><td>Minimalna wartość PWM do testu </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pwm_max</td><td>Maksymalna wartość PWM do testu</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true Test wykonany pomyślnie </dd>
<dd>
false Błąd (nieprawidłowy handle, kanał lub komunikacja I2C)</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Funkcja blokuje wykonanie na 6 sekund (3x 2s delay) </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Używaj ostrożnie! Niewłaściwe wartości PWM mogą uszkodzić serwo</dd></dl>
<div class="fragment"><div class="line"><span class="comment">// Test szerokiego zakresu dla znajdowania limitów</span></div>
<div class="line"><a class="code hl_function" href="group___p_c_a9685___functions.html#gae723d43fb9f64618bec71ee56f9c53d0">PCA9685_TestPWMRange</a>(&amp;<a class="code hl_variable" href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a>, 0, 100, 600);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Test wąskiego zakresu dla precyzji</span></div>
<div class="line"><a class="code hl_function" href="group___p_c_a9685___functions.html#gae723d43fb9f64618bec71ee56f9c53d0">PCA9685_TestPWMRange</a>(&amp;<a class="code hl_variable" href="main_8c.html#ae574d11146c164ecae358a62f95f0256">pca1</a>, 0, 300, 310);</div>
<div class="ttc" id="agroup___p_c_a9685___functions_html_gae723d43fb9f64618bec71ee56f9c53d0"><div class="ttname"><a href="group___p_c_a9685___functions.html#gae723d43fb9f64618bec71ee56f9c53d0">PCA9685_TestPWMRange</a></div><div class="ttdeci">bool PCA9685_TestPWMRange(PCA9685_Handle_t *handle, uint8_t channel, uint16_t pwm_min, uint16_t pwm_max)</div><div class="ttdoc">Test różnych zakresów PWM dla kalibracji serw.</div><div class="ttdef"><b>Definition</b> <a href="pca9685_8c_source.html#l00110">pca9685.c:110</a></div></div>
</div><!-- fragment --><p>Test różnych zakresów PWM dla kalibracji serw. </p>

<p class="definition">Definition at line <a class="el" href="pca9685_8c_source.html#l00110">110</a> of file <a class="el" href="pca9685_8c_source.html">pca9685.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
